<DOCFLEX_TEMPLATE VER='1.12'>
CREATED='2004-12-27 07:08:00'
LAST_UPDATE='2008-12-27 04:19:41'
DESIGNER_TOOL='DocFlex SDK 1.x'
DESIGNER_LICENSE_TYPE='Filigris Works Team'
TEMPLATE_TYPE='DocumentTemplate'
DSM_TYPE_ID='sales'
ROOT_ET='e5SalesExport'
FMT={
	doc.lengthUnits='pt';
	doc.hlink.style.link='cs2';
	doc.paper.size='A4';
	doc.paper.width='595.4';
	doc.paper.height='841.7';
	doc.page.margin.top='56.9';
	doc.page.margin.bottom='56.9';
	doc.page.margin.left='42.5';
	doc.page.margin.right='42.5';
	doc.page.margin.header='28.1';
	doc.page.margin.footer='28.1';
}
<STYLES>
	CHAR_STYLE={
		style.name='Default Paragraph Font';
		style.id='cs1';
		style.default='true';
	}
	CHAR_STYLE={
		style.name='Hyperlink';
		style.id='cs2';
		text.decor.underline='true';
		text.color.foreground='#0000FF';
	}
	PAR_STYLE={
		style.name='Normal';
		style.id='s1';
		style.default='true';
	}
</STYLES>
<PAGE_FOOTER>
	<AREA_SEC>
		FMT={
			sec.outputStyle='table';
			text.font.style.italic='true';
			table.sizing='Relative';
			table.cellpadding.horz='0';
			table.border.style='none';
			table.border.top.style='solid';
		}
		<AREA>
			<CTRL_GROUP>
				<CTRLS>
					<PANEL>
						FMT={
							ctrl.size.width='305.3';
							ctrl.size.height='39.8';
						}
						<AREA>
							<CTRL_GROUP>
								<CTRLS>
									<LABEL>
										TEXT='DocFlex Sales (from'
									</LABEL>
									<DATA_CTRL>
										LPATH='RangeFromDate'
										PATTERN='SHORT'
									</DATA_CTRL>
									<LABEL>
										TEXT='to'
									</LABEL>
									<DATA_CTRL>
										LPATH='RangeToDate'
										PATTERN='SHORT'
									</DATA_CTRL>
									<DELIMITER>
										FMT={
											txtfl.delimiter.type='none';
										}
									</DELIMITER>
									<LABEL>
										TEXT=')'
									</LABEL>
								</CTRLS>
							</CTRL_GROUP>
						</AREA>
					</PANEL>
					<PANEL>
						FMT={
							ctrl.size.width='194.3';
							ctrl.size.height='39.8';
							tcell.align.horz='Right';
						}
						<AREA>
							<CTRL_GROUP>
								<CTRLS>
									<LABEL>
										TEXT='Page'
									</LABEL>
									<DATA_CTRL>
										DOCFIELD='page'
									</DATA_CTRL>
									<LABEL>
										TEXT='of'
									</LABEL>
									<DATA_CTRL>
										DOCFIELD='num-pages'
									</DATA_CTRL>
								</CTRLS>
							</CTRL_GROUP>
						</AREA>
					</PANEL>
				</CTRLS>
			</CTRL_GROUP>
		</AREA>
	</AREA_SEC>
</PAGE_FOOTER>
<ROOT>
	<AREA_SEC>
		<AREA>
			<CTRL_GROUP>
				FMT={
					par.alignment='Center';
					par.margin.bottom='24';
				}
				<CTRLS>
					<LABEL>
						FMT={
							text.font.name='Comic Sans MS';
							text.font.size='24';
							text.font.style.bold='true';
							text.color.foreground='#CC0099';
						}
						TEXT='*** DocFlex Sales ***'
					</LABEL>
				</CTRLS>
			</CTRL_GROUP>
		</AREA>
	</AREA_SEC>
	<AREA_SEC>
		FMT={
			text.font.name='Comic Sans MS';
			text.font.size='11';
			text.color.foreground='#0000FF';
		}
		<AREA>
			<CTRL_GROUP>
				<CTRLS>
					<LABEL>
						TEXT='The following is a mock DocFlex sales report.'
					</LABEL>
				</CTRLS>
			</CTRL_GROUP>
			<CTRL_GROUP>
				<CTRLS>
					<LABEL>
						TEXT='(In fact, only data are mock, anything else is deadly serious!)'
					</LABEL>
				</CTRLS>
			</CTRL_GROUP>
		</AREA>
	</AREA_SEC>
	<ELEMENT_ITER>
		DESCR='SALES POSITIONS BY DATE -- iterates by all purchases (with sorting by purchase date)'
		INIT_EXPR='setVar("pos",0);\nsetVar("total_quantity",0);\nsetVar("total_price",0);\nsetVar("total_vat",0);'
		FMT={
			sec.outputStyle='table';
			table.cellpadding.horz='3';
			table.border.style='double';
			table.border.color='#666666';
			table.border.horz.style='solid';
			table.border.horz.thickness='thin';
			table.border.vert.style='solid';
			table.border.vert.thickness='thin';
			table.page.repeatHeader='true';
		}
		TARGET_ET='Purchase'
		SCOPE='simple-location-rules'
		RULES={
			'* -> Purchase';
		}
		SORTING='by-lpath'
		SORTING_KEY={lpath='PurchaseDate',ascending}
		<BODY>
			<ELEMENT_ITER>
				DESCR='iterates by all items within a parchase (sorting is natural)'
				TARGET_ET='PurchaseItem'
				SCOPE='simple-location-rules'
				RULES={
					'* -> PurchaseItem';
				}
				STEP_EXPR='output.generating ? \n{\n  incVar("pos", 1);\n\n  quantity = getValueByLPath ("Quantity").toNumber();\n  incVar("total_quantity", quantity);\n\n  price = round (getValueByLPath ("ProductSinglePrice").toNumber() * quantity, 2);\n  incVar("total_price", price);\n\n  vat = round (price * getValueByLPath ("VatPct").toNumber() / 100, 2);\n  incVar("total_vat", vat);\n}'
				<BODY>
					<FOLDER>
						DESCR='print odd row'
						COND='getNumberVar("pos") % 2 != 0'
						BREAK_PARENT_BLOCK='when-executed'
						<BODY>
							<AREA_SEC>
								COND='iterator.itemNo == 1'
								BREAK_PARENT_BLOCK='when-executed'
								<AREA>
									<CTRL_GROUP>
										<CTRLS>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='27';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												FORMULA='getVar("pos")'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='39.8';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												FORMULA='format (\n  contextElement.parent.getValueByLPath ("PurchaseDate").toDate(),\n  "SHORT", null\n)'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='97.5';
													ctrl.size.height='18';
												}
												FORMULA='contextElement.parent.getValueByLPath("CustomerData/RegName")'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='59.3';
													ctrl.size.height='18';
												}
												LPATH='ProductName'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='75.8';
													ctrl.size.height='18';
													tcell.align.horz='Right';
												}
												LPATH='ProductSinglePrice'
												PATTERN='0 \u20ac'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='43.5';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												LPATH='Quantity'
												PATTERN='0'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='34.5';
													ctrl.size.height='18';
													tcell.align.horz='Right';
												}
												FORMULA='price = round (getValueByLPath ("ProductSinglePrice").toNumber() *\n  getValueByLPath ("Quantity").toNumber(), 2);\nprice.format()'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='27.8';
													ctrl.size.height='18';
													tcell.align.horz='Right';
												}
												FORMULA='price = round (getValueByLPath ("ProductSinglePrice").toNumber() *\n  getValueByLPath ("Quantity").toNumber(), 2);\n\nvat = round (price * getValueByLPath ("VatPct").toNumber() / 100, 2);\nvat.format()'
											</DATA_CTRL>
											<IMAGE_CTRL>
												FMT={
													ctrl.size.width='94.5';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												IMAGE_TYPE='dynamic-image'
												OBJ_EXPR='getValueByLPath("PurchaseItemKey/Data").toBinary()'
											</IMAGE_CTRL>
										</CTRLS>
									</CTRL_GROUP>
								</AREA>
							</AREA_SEC>
							<AREA_SEC>
								<AREA>
									<CTRL_GROUP>
										<CTRLS>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='27';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												FORMULA='getVar("pos")'
											</DATA_CTRL>
											<LABEL>
												FMT={
													ctrl.size.width='39.8';
													ctrl.size.height='18';
													tcell.align.horz='Center';
													text.font.name='Courier New';
													text.font.size='8';
												}
												TEXT='- // -'
											</LABEL>
											<LABEL>
												FMT={
													ctrl.size.width='96.8';
													ctrl.size.height='18';
													tcell.align.horz='Center';
													text.font.name='Courier New';
													text.font.size='8';
												}
												TEXT='- // -'
											</LABEL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='60';
													ctrl.size.height='18';
												}
												LPATH='ProductName'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='76.5';
													ctrl.size.height='18';
													tcell.align.horz='Right';
												}
												LPATH='ProductSinglePrice'
												PATTERN='0 \u20ac'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='42.8';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												LPATH='Quantity'
												PATTERN='0'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='35.3';
													ctrl.size.height='18';
													tcell.align.horz='Right';
												}
												FORMULA='price = round (getValueByLPath ("ProductSinglePrice").toNumber() *\n  getValueByLPath ("Quantity").toNumber(), 2);\nprice.format()'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='27.8';
													ctrl.size.height='18';
													tcell.align.horz='Right';
												}
												FORMULA='price = round (getValueByLPath ("ProductSinglePrice").toNumber() *\n  getValueByLPath ("Quantity").toNumber(), 2);\n\nvat = round (price * getValueByLPath ("VatPct").toNumber() / 100, 2);\nvat.format()'
											</DATA_CTRL>
											<IMAGE_CTRL>
												FMT={
													ctrl.size.width='93.8';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												IMAGE_TYPE='dynamic-image'
												OBJ_EXPR='getValueByLPath("PurchaseItemKey/Data").toBinary()'
											</IMAGE_CTRL>
										</CTRLS>
									</CTRL_GROUP>
								</AREA>
							</AREA_SEC>
						</BODY>
					</FOLDER>
					<FOLDER>
						DESCR='otherwise, print even row'
						<BODY>
							<AREA_SEC>
								COND='iterator.itemNo == 1'
								BREAK_PARENT_BLOCK='when-executed'
								<AREA>
									<CTRL_GROUP>
										FMT={
											trow.bkgr.color='#F0F0FF';
										}
										<CTRLS>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='27';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												FORMULA='getVar("pos")'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='39.8';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												FORMULA='format (\n  contextElement.parent.getValueByLPath ("PurchaseDate").toDate(),\n  "SHORT", null\n)'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='97.5';
													ctrl.size.height='18';
												}
												FORMULA='contextElement.parent.getValueByLPath("CustomerData/RegName")'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='59.3';
													ctrl.size.height='18';
												}
												LPATH='ProductName'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='75.8';
													ctrl.size.height='18';
													tcell.align.horz='Right';
												}
												LPATH='ProductSinglePrice'
												PATTERN='0 \u20ac'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='43.5';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												LPATH='Quantity'
												PATTERN='0'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='34.5';
													ctrl.size.height='18';
													tcell.align.horz='Right';
												}
												FORMULA='price = round (getValueByLPath ("ProductSinglePrice").toNumber() *\n  getValueByLPath ("Quantity").toNumber(), 2);\nprice.format()'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='29.3';
													ctrl.size.height='18';
													tcell.align.horz='Right';
												}
												FORMULA='price = round (getValueByLPath ("ProductSinglePrice").toNumber() *\n  getValueByLPath ("Quantity").toNumber(), 2);\n\nvat = round (price * getValueByLPath ("VatPct").toNumber() / 100, 2);\nvat.format()'
											</DATA_CTRL>
											<IMAGE_CTRL>
												FMT={
													ctrl.size.width='93';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												IMAGE_TYPE='dynamic-image'
												OBJ_EXPR='getValueByLPath("PurchaseItemKey/Data").toBinary()'
											</IMAGE_CTRL>
										</CTRLS>
									</CTRL_GROUP>
								</AREA>
							</AREA_SEC>
							<AREA_SEC>
								<AREA>
									<CTRL_GROUP>
										FMT={
											trow.bkgr.color='#F0F0FF';
										}
										<CTRLS>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='27';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												FORMULA='getVar("pos")'
											</DATA_CTRL>
											<LABEL>
												FMT={
													ctrl.size.width='39.8';
													ctrl.size.height='18';
													tcell.align.horz='Center';
													text.font.name='Courier New';
													text.font.size='8';
												}
												TEXT='- // -'
											</LABEL>
											<LABEL>
												FMT={
													ctrl.size.width='96.8';
													ctrl.size.height='18';
													tcell.align.horz='Center';
													text.font.name='Courier New';
													text.font.size='8';
												}
												TEXT='- // -'
											</LABEL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='60';
													ctrl.size.height='18';
												}
												LPATH='ProductName'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='76.5';
													ctrl.size.height='18';
													tcell.align.horz='Right';
												}
												LPATH='ProductSinglePrice'
												PATTERN='0 \u20ac'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='42.8';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												LPATH='Quantity'
												PATTERN='0'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='36';
													ctrl.size.height='18';
													tcell.align.horz='Right';
												}
												FORMULA='price = round (getValueByLPath ("ProductSinglePrice").toNumber() *\n  getValueByLPath ("Quantity").toNumber(), 2);\nprice.format()'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='29.3';
													ctrl.size.height='18';
													tcell.align.horz='Right';
												}
												FORMULA='price = round (getValueByLPath ("ProductSinglePrice").toNumber() *\n  getValueByLPath ("Quantity").toNumber(), 2);\n\nvat = round (price * getValueByLPath ("VatPct").toNumber() / 100, 2);\nvat.format()'
											</DATA_CTRL>
											<IMAGE_CTRL>
												FMT={
													ctrl.size.width='91.5';
													ctrl.size.height='18';
													tcell.align.horz='Center';
												}
												IMAGE_TYPE='dynamic-image'
												OBJ_EXPR='getValueByLPath("PurchaseItemKey/Data").toBinary()'
											</IMAGE_CTRL>
										</CTRLS>
									</CTRL_GROUP>
								</AREA>
							</AREA_SEC>
						</BODY>
					</FOLDER>
				</BODY>
			</ELEMENT_ITER>
		</BODY>
		<HEADER>
			DESCR='executed only once to print the table header'
			<AREA_SEC>
				FMT={
					sec.outputStyle='pars';
				}
				<AREA>
					<CTRL_GROUP>
						FMT={
							text.font.style.bold='true';
							txtfl.delimiter.type='none';
							par.margin.top='22.5';
							par.margin.bottom='2.3';
						}
						<CTRLS>
							<LABEL>
								TEXT='Sales positions from '
							</LABEL>
							<DATA_CTRL>
								LPATH='RangeFromDate'
								PATTERN='SHORT'
							</DATA_CTRL>
							<LABEL>
								TEXT=' to '
							</LABEL>
							<DATA_CTRL>
								LPATH='RangeToDate'
								PATTERN='SHORT'
							</DATA_CTRL>
							<LABEL>
								TEXT=':'
							</LABEL>
						</CTRLS>
					</CTRL_GROUP>
				</AREA>
			</AREA_SEC>
			<AREA_SEC>
				<AREA>
					<CTRL_GROUP>
						FMT={
							trow.align.horz='Center';
							trow.bkgr.color='#FFF2CC';
							text.font.style.bold='true';
						}
						<CTRLS>
							<LABEL>
								FMT={
									ctrl.size.width='27';
									ctrl.size.height='17.3';
								}
								TEXT='Pos'
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='39';
									ctrl.size.height='17.3';
									txtfl.option.renderEmbeddedHTML='true';
								}
								TEXT='Date'
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='97.5';
									ctrl.size.height='17.3';
								}
								TEXT='Customer'
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='60';
									ctrl.size.height='17.3';
								}
								TEXT='Product'
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='74.3';
									ctrl.size.height='17.3';
									txtfl.option.renderEmbeddedHTML='true';
								}
								TEXT='Single<br>Price'
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='44.3';
									ctrl.size.height='17.3';
								}
								TEXT='Quantity'
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='33.8';
									ctrl.size.height='17.3';
									tcell.align.horz='Right';
									txtfl.option.renderEmbeddedHTML='true';
								}
								TEXT='Price<br>\u20ac'
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='29.3';
									ctrl.size.height='17.3';
									tcell.align.horz='Right';
									txtfl.option.renderEmbeddedHTML='true';
								}
								TEXT='VAT<br>\u20ac'
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='94.5';
									ctrl.size.height='17.3';
									txtfl.option.renderEmbeddedHTML='true';
								}
								TEXT='License<br>Certificate'
							</LABEL>
						</CTRLS>
					</CTRL_GROUP>
				</AREA>
			</AREA_SEC>
		</HEADER>
		<FOOTER>
			DESCR='executed only once as the table footer;  prints all totals'
			<AREA_SEC>
				<AREA>
					<CTRL_GROUP>
						FMT={
							trow.border.horz.style='double';
							trow.border.vert.style='none';
							text.font.style.bold='true';
						}
						<CTRLS>
							<LABEL>
								FMT={
									ctrl.size.width='300';
									ctrl.size.height='18.8';
									tcell.align.horz='Right';
								}
								TEXT='Total:'
							</LABEL>
							<DATA_CTRL>
								FMT={
									ctrl.size.width='42.8';
									ctrl.size.height='18.8';
									tcell.align.horz='Center';
								}
								FORMULA='getVar("total_quantity")'
							</DATA_CTRL>
							<DATA_CTRL>
								FMT={
									ctrl.size.width='34.5';
									ctrl.size.height='18.8';
									tcell.align.horz='Right';
								}
								FORMULA='getNumberVar("total_price").format()'
							</DATA_CTRL>
							<DATA_CTRL>
								FMT={
									ctrl.size.width='30.8';
									ctrl.size.height='18.8';
									tcell.align.horz='Right';
								}
								FORMULA='getNumberVar("total_vat").format()'
							</DATA_CTRL>
							<LABEL>
								FMT={
									ctrl.size.width='91.5';
									ctrl.size.height='18.8';
								}
								TEXT=''
							</LABEL>
						</CTRLS>
					</CTRL_GROUP>
				</AREA>
			</AREA_SEC>
		</FOOTER>
	</ELEMENT_ITER>
	<ELEMENT_ITER>
		DESCR='SALES BY PRODUCT -- this iterates by products (scope is sorted by product name and duplications removed)'
		INIT_EXPR='setVar("total_quantity",0);\nsetVar("total_price",0);'
		FMT={
			sec.outputStyle='table';
			table.cellpadding.horz='3';
			table.border.style='double';
			table.border.color='#666666';
			table.border.horz.style='solid';
			table.border.horz.thickness='thin';
			table.border.vert.style='solid';
			table.border.vert.thickness='thin';
		}
		TARGET_ET='PurchaseItem'
		SCOPE='simple-location-rules'
		RULES={
			'* -> descendant::PurchaseItem';
		}
		SORTING='by-lpath'
		SORTING_KEY={lpath='ProductName',ascending,unique}
		<BODY>
			<ELEMENT_ITER>
				DESCR='prints data about the product (iterates by all purchase items related to it)'
				INIT_EXPR='setVar("prod_total_quantity",0);\nsetVar("prod_total_price",0);'
				TARGET_ET='PurchaseItem'
				SCOPE='custom'
				ELEMENT_ENUM_EXPR='productName = getValueByLPath("ProductName");\n\nrootElement.findElementsByLPath (\n "descendant::PurchaseItem [getValueByLPath(\'ProductName\') == productName]"\n)'
				SORTING='by-expr'
				SORTING_KEY={expr='contextElement.parent.getValueByLPath("PurchaseDate").toDate()',ascending}
				STEP_EXPR='output.generating ? \n{\n  quantity = getValueByLPath ("Quantity").toNumber();\n  incVar("prod_total_quantity", quantity);\n  incVar("total_quantity", quantity);\n\n  price = round (getValueByLPath ("ProductSinglePrice").toNumber() * quantity, 2);\n  incVar("prod_total_price", price);\n  incVar("total_price", price);\n}\n'
				<BODY>
					<FOLDER>
						DESCR='print odd row'
						COND='iterator.itemNo.toNumber() % 2 != 0'
						BREAK_PARENT_BLOCK='when-executed'
						<BODY>
							<AREA_SEC>
								COND='iterator.itemNo == 1'
								BREAK_PARENT_BLOCK='when-executed'
								<AREA>
									<CTRL_GROUP>
										FMT={
											trow.bkgr.color='#F0F0FF';
										}
										<CTRLS>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='25.5';
													ctrl.size.height='17.3';
													tcell.align.horz='Center';
												}
												FORMULA='iterator.parentIterator.itemNo'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='108.8';
													ctrl.size.height='17.3';
													text.font.style.bold='true';
												}
												LPATH='ProductName'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='51';
													ctrl.size.height='17.3';
													tcell.align.horz='Center';
												}
												FORMULA='format (\n  contextElement.parent.getValueByLPath ("PurchaseDate").toDate(),\n  "SHORT", null\n)'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='115.5';
													ctrl.size.height='17.3';
												}
												FORMULA='contextElement.parent.getValueByLPath("CustomerData/RegName")'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='78';
													ctrl.size.height='17.3';
													tcell.align.horz='Right';
												}
												LPATH='ProductSinglePrice'
												PATTERN='0 \u20ac'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='47.3';
													ctrl.size.height='17.3';
													tcell.align.horz='Center';
												}
												LPATH='Quantity'
												PATTERN='0'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='73.5';
													ctrl.size.height='17.3';
													tcell.align.horz='Right';
												}
												FORMULA='price = round (getValueByLPath ("ProductSinglePrice").toNumber() *\n  getValueByLPath ("Quantity").toNumber(), 2);\nprice.format()'
											</DATA_CTRL>
										</CTRLS>
									</CTRL_GROUP>
								</AREA>
							</AREA_SEC>
							<AREA_SEC>
								<AREA>
									<CTRL_GROUP>
										FMT={
											trow.bkgr.color='#F0F0FF';
										}
										<CTRLS>
											<LABEL>
												FMT={
													ctrl.size.width='25.5';
													ctrl.size.height='17.3';
												}
												TEXT=''
											</LABEL>
											<LABEL>
												FMT={
													ctrl.size.width='108.8';
													ctrl.size.height='17.3';
													tcell.align.horz='Center';
													text.font.name='Courier New';
													text.font.size='8';
												}
												TEXT='- // -'
											</LABEL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='50.3';
													ctrl.size.height='17.3';
													tcell.align.horz='Center';
												}
												FORMULA='format (\n  contextElement.parent.getValueByLPath ("PurchaseDate").toDate(),\n  "SHORT", null\n)'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='115.5';
													ctrl.size.height='17.3';
												}
												FORMULA='contextElement.parent.getValueByLPath("CustomerData/RegName")'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='80.3';
													ctrl.size.height='17.3';
													tcell.align.horz='Right';
												}
												LPATH='ProductSinglePrice'
												PATTERN='0 \u20ac'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='45';
													ctrl.size.height='17.3';
													tcell.align.horz='Center';
												}
												LPATH='Quantity'
												PATTERN='0'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='74.3';
													ctrl.size.height='17.3';
													tcell.align.horz='Right';
												}
												FORMULA='price = round (getValueByLPath ("ProductSinglePrice").toNumber() *\n  getValueByLPath ("Quantity").toNumber(), 2);\nprice.format()'
											</DATA_CTRL>
										</CTRLS>
									</CTRL_GROUP>
								</AREA>
							</AREA_SEC>
						</BODY>
					</FOLDER>
					<FOLDER>
						DESCR='otherwise, print even row'
						<BODY>
							<AREA_SEC>
								<AREA>
									<CTRL_GROUP>
										FMT={
											trow.bkgr.color='#FFF3F3';
										}
										<CTRLS>
											<LABEL>
												FMT={
													ctrl.size.width='24.8';
													ctrl.size.height='17.3';
												}
												TEXT=''
											</LABEL>
											<LABEL>
												FMT={
													ctrl.size.width='108.8';
													ctrl.size.height='17.3';
													tcell.align.horz='Center';
													text.font.name='Courier New';
													text.font.size='8';
												}
												TEXT='- // -'
											</LABEL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='50.3';
													ctrl.size.height='17.3';
													tcell.align.horz='Center';
												}
												FORMULA='format (\n  contextElement.parent.getValueByLPath ("PurchaseDate").toDate(),\n  "SHORT", null\n)'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='116.3';
													ctrl.size.height='17.3';
												}
												FORMULA='contextElement.parent.getValueByLPath ("CustomerData/RegName").toString()'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='79.5';
													ctrl.size.height='17.3';
													tcell.align.horz='Right';
												}
												LPATH='ProductSinglePrice'
												PATTERN='0 \u20ac'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='46.5';
													ctrl.size.height='17.3';
													tcell.align.horz='Center';
												}
												LPATH='Quantity'
												PATTERN='0'
											</DATA_CTRL>
											<DATA_CTRL>
												FMT={
													ctrl.size.width='73.5';
													ctrl.size.height='17.3';
													tcell.align.horz='Right';
												}
												FORMULA='price = round (getValueByLPath ("ProductSinglePrice").toNumber() *\n  getValueByLPath ("Quantity").toNumber(), 2);\nprice.format()'
											</DATA_CTRL>
										</CTRLS>
									</CTRL_GROUP>
								</AREA>
							</AREA_SEC>
						</BODY>
					</FOLDER>
				</BODY>
				<FOOTER>
					DESCR='print totals for the product'
					<AREA_SEC>
						<AREA>
							<CTRL_GROUP>
								FMT={
									trow.border.vert.style='none';
									text.font.style.bold='true';
								}
								<CTRLS>
									<LABEL>
										FMT={
											ctrl.size.width='380.3';
											ctrl.size.height='17.3';
											tcell.align.horz='Right';
										}
										TEXT='Total:'
									</LABEL>
									<DATA_CTRL>
										FMT={
											ctrl.size.width='46.5';
											ctrl.size.height='17.3';
											tcell.align.horz='Center';
										}
										FORMULA='getVar("prod_total_quantity")'
									</DATA_CTRL>
									<DATA_CTRL>
										FMT={
											ctrl.size.width='72.8';
											ctrl.size.height='17.3';
											tcell.align.horz='Right';
										}
										FORMULA='getNumberVar("prod_total_price").format()'
									</DATA_CTRL>
								</CTRLS>
							</CTRL_GROUP>
						</AREA>
					</AREA_SEC>
				</FOOTER>
			</ELEMENT_ITER>
		</BODY>
		<HEADER>
			DESCR='executed only once to print the table header'
			<AREA_SEC>
				FMT={
					sec.outputStyle='pars';
				}
				<AREA>
					<CTRL_GROUP>
						FMT={
							text.font.style.bold='true';
							txtfl.delimiter.type='none';
							par.margin.top='22.5';
							par.margin.bottom='2.3';
							par.page.breakBefore='true';
						}
						<CTRLS>
							<LABEL>
								TEXT='Sales by product:'
							</LABEL>
						</CTRLS>
					</CTRL_GROUP>
				</AREA>
			</AREA_SEC>
			<AREA_SEC>
				<AREA>
					<CTRL_GROUP>
						FMT={
							trow.align.horz='Center';
							trow.bkgr.color='#FFF2CC';
							text.font.style.bold='true';
						}
						<CTRLS>
							<LABEL>
								FMT={
									ctrl.size.width='25.5';
									ctrl.size.height='17.3';
									text.option.nbsps='true';
								}
								TEXT=' # '
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='110.3';
									ctrl.size.height='17.3';
								}
								TEXT='Product'
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='48.8';
									ctrl.size.height='17.3';
									txtfl.option.renderEmbeddedHTML='true';
								}
								TEXT='Date'
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='117';
									ctrl.size.height='17.3';
								}
								TEXT='Customer'
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='79.5';
									ctrl.size.height='17.3';
									txtfl.option.renderEmbeddedHTML='true';
								}
								TEXT='Single<br>Price'
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='44.3';
									ctrl.size.height='17.3';
								}
								TEXT='Quantity'
							</LABEL>
							<LABEL>
								FMT={
									ctrl.size.width='74.3';
									ctrl.size.height='17.3';
									tcell.align.horz='Right';
									txtfl.option.renderEmbeddedHTML='true';
								}
								TEXT='Price<br>\u20ac'
							</LABEL>
						</CTRLS>
					</CTRL_GROUP>
				</AREA>
			</AREA_SEC>
		</HEADER>
		<FOOTER>
			DESCR='print totals by all products'
			<AREA_SEC>
				<AREA>
					<CTRL_GROUP>
						FMT={
							trow.border.horz.style='double';
							trow.border.vert.style='none';
							text.font.style.bold='true';
						}
						<CTRLS>
							<LABEL>
								FMT={
									ctrl.size.width='378.8';
									ctrl.size.height='18.8';
									tcell.align.horz='Right';
								}
								TEXT='Overall:'
							</LABEL>
							<DATA_CTRL>
								FMT={
									ctrl.size.width='48';
									ctrl.size.height='18.8';
									tcell.align.horz='Center';
								}
								FORMULA='getVar("total_quantity")'
							</DATA_CTRL>
							<DATA_CTRL>
								FMT={
									ctrl.size.width='72.8';
									ctrl.size.height='18.8';
									tcell.align.horz='Right';
								}
								FORMULA='getNumberVar("total_price").format()'
							</DATA_CTRL>
						</CTRLS>
					</CTRL_GROUP>
				</AREA>
			</AREA_SEC>
		</FOOTER>
	</ELEMENT_ITER>
</ROOT>
CHECKSUM='DHkdhjTfwAMVcChw0F4Gfkl6ah1XriLogJgH6zM9J1k'
</DOCFLEX_TEMPLATE>